:doc:`EC2 <../../ec2>` / Client / lock_snapshot

*************
lock_snapshot
*************



.. py:method:: EC2.Client.lock_snapshot(**kwargs)

  

  Locks an Amazon EBS snapshot in either *governance* or *compliance* mode to protect it against accidental or malicious deletions for a specific duration. A locked snapshot can't be deleted.

   

  You can also use this action to modify the lock settings for a snapshot that is already locked. The allowed modifications depend on the lock mode and lock state:

   

  
  * If the snapshot is locked in governance mode, you can modify the lock mode and the lock duration or lock expiration date.
   
  * If the snapshot is locked in compliance mode and it is in the cooling-off period, you can modify the lock mode and the lock duration or lock expiration date.
   
  * If the snapshot is locked in compliance mode and the cooling-off period has lapsed, you can only increase the lock duration or extend the lock expiration date.
  

  

  See also: `AWS API Documentation <https://docs.aws.amazon.com/goto/WebAPI/ec2-2016-11-15/LockSnapshot>`_  


  **Request Syntax**
  ::

    response = client.lock_snapshot(
        SnapshotId='string',
        DryRun=True|False,
        LockMode='compliance'|'governance',
        CoolOffPeriod=123,
        LockDuration=123,
        ExpirationDate=datetime(2015, 1, 1)
    )
    
  :type SnapshotId: string
  :param SnapshotId: **[REQUIRED]** 

    The ID of the snapshot to lock.

    

  
  :type DryRun: boolean
  :param DryRun: 

    Checks whether you have the required permissions for the action, without actually making the request, and provides an error response. If you have the required permissions, the error response is ``DryRunOperation``. Otherwise, it is ``UnauthorizedOperation``.

    

  
  :type LockMode: string
  :param LockMode: **[REQUIRED]** 

    The mode in which to lock the snapshot. Specify one of the following:

     

    
    * ``governance`` - Locks the snapshot in governance mode. Snapshots locked in governance mode can't be deleted until one of the following conditions are met: 

      
      * The lock duration expires.
       
      * The snapshot is unlocked by a user with the appropriate permissions.
      

     

    Users with the appropriate IAM permissions can unlock the snapshot, increase or decrease the lock duration, and change the lock mode to ``compliance`` at any time.

     

    If you lock a snapshot in ``governance`` mode, omit **CoolOffPeriod**.

    
     
    * ``compliance`` - Locks the snapshot in compliance mode. Snapshots locked in compliance mode can't be unlocked by any user. They can be deleted only after the lock duration expires. Users can't decrease the lock duration or change the lock mode to ``governance``. However, users with appropriate IAM permissions can increase the lock duration at any time. If you lock a snapshot in ``compliance`` mode, you can optionally specify **CoolOffPeriod**.
    

    

  
  :type CoolOffPeriod: integer
  :param CoolOffPeriod: 

    The cooling-off period during which you can unlock the snapshot or modify the lock settings after locking the snapshot in compliance mode, in hours. After the cooling-off period expires, you can't unlock or delete the snapshot, decrease the lock duration, or change the lock mode. You can increase the lock duration after the cooling-off period expires.

     

    The cooling-off period is optional when locking a snapshot in compliance mode. If you are locking the snapshot in governance mode, omit this parameter.

     

    To lock the snapshot in compliance mode immediately without a cooling-off period, omit this parameter.

     

    If you are extending the lock duration for a snapshot that is locked in compliance mode after the cooling-off period has expired, omit this parameter. If you specify a cooling-period in a such a request, the request fails.

     

    Allowed values: Min 1, max 72.

    

  
  :type LockDuration: integer
  :param LockDuration: 

    The period of time for which to lock the snapshot, in days. The snapshot lock will automatically expire after this period lapses.

     

    You must specify either this parameter or **ExpirationDate**, but not both.

     

    Allowed values: Min: 1, max 36500

    

  
  :type ExpirationDate: datetime
  :param ExpirationDate: 

    The date and time at which the snapshot lock is to automatically expire, in the UTC time zone ( ``YYYY-MM-DDThh:mm:ss.sssZ``).

     

    You must specify either this parameter or **LockDuration**, but not both.

    

  
  
  :rtype: dict
  :returns: 
    
    **Response Syntax**

    
    ::

      {
          'SnapshotId': 'string',
          'LockState': 'compliance'|'governance'|'compliance-cooloff'|'expired',
          'LockDuration': 123,
          'CoolOffPeriod': 123,
          'CoolOffPeriodExpiresOn': datetime(2015, 1, 1),
          'LockCreatedOn': datetime(2015, 1, 1),
          'LockExpiresOn': datetime(2015, 1, 1),
          'LockDurationStartTime': datetime(2015, 1, 1)
      }
      
    **Response Structure**

    

    - *(dict) --* 
      

      - **SnapshotId** *(string) --* 

        The ID of the snapshot

        
      

      - **LockState** *(string) --* 

        The state of the snapshot lock. Valid states include:

         

        
        * ``compliance-cooloff`` - The snapshot has been locked in compliance mode but it is still within the cooling-off period. The snapshot can't be deleted, but it can be unlocked and the lock settings can be modified by users with appropriate permissions.
         
        * ``governance`` - The snapshot is locked in governance mode. The snapshot can't be deleted, but it can be unlocked and the lock settings can be modified by users with appropriate permissions.
         
        * ``compliance`` - The snapshot is locked in compliance mode and the cooling-off period has expired. The snapshot can't be unlocked or deleted. The lock duration can only be increased by users with appropriate permissions.
         
        * ``expired`` - The snapshot was locked in compliance or governance mode but the lock duration has expired. The snapshot is not locked and can be deleted.
        

        
      

      - **LockDuration** *(integer) --* 

        The period of time for which the snapshot is locked, in days.

        
      

      - **CoolOffPeriod** *(integer) --* 

        The compliance mode cooling-off period, in hours.

        
      

      - **CoolOffPeriodExpiresOn** *(datetime) --* 

        The date and time at which the compliance mode cooling-off period expires, in the UTC time zone ( ``YYYY-MM-DDThh:mm:ss.sssZ``).

        
      

      - **LockCreatedOn** *(datetime) --* 

        The date and time at which the snapshot was locked, in the UTC time zone ( ``YYYY-MM-DDThh:mm:ss.sssZ``).

        
      

      - **LockExpiresOn** *(datetime) --* 

        The date and time at which the lock will expire, in the UTC time zone ( ``YYYY-MM-DDThh:mm:ss.sssZ``).

        
      

      - **LockDurationStartTime** *(datetime) --* 

        The date and time at which the lock duration started, in the UTC time zone ( ``YYYY-MM-DDThh:mm:ss.sssZ``).

        
  