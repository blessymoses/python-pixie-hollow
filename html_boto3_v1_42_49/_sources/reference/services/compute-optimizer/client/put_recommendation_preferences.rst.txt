:doc:`ComputeOptimizer <../../compute-optimizer>` / Client / put_recommendation_preferences

******************************
put_recommendation_preferences
******************************



.. py:method:: ComputeOptimizer.Client.put_recommendation_preferences(**kwargs)

  

  Creates a new recommendation preference or updates an existing recommendation preference, such as enhanced infrastructure metrics.

   

  For more information, see `Activating enhanced infrastructure metrics <https://docs.aws.amazon.com/compute-optimizer/latest/ug/enhanced-infrastructure-metrics.html>`__ in the *Compute Optimizer User Guide*.

  

  See also: `AWS API Documentation <https://docs.aws.amazon.com/goto/WebAPI/compute-optimizer-2019-11-01/PutRecommendationPreferences>`_  


  **Request Syntax**
  ::

    response = client.put_recommendation_preferences(
        resourceType='Ec2Instance'|'AutoScalingGroup'|'EbsVolume'|'LambdaFunction'|'NotApplicable'|'EcsService'|'License'|'RdsDBInstance'|'AuroraDBClusterStorage'|'Idle',
        scope={
            'name': 'Organization'|'AccountId'|'ResourceArn',
            'value': 'string'
        },
        enhancedInfrastructureMetrics='Active'|'Inactive',
        inferredWorkloadTypes='Active'|'Inactive',
        externalMetricsPreference={
            'source': 'Datadog'|'Dynatrace'|'NewRelic'|'Instana'
        },
        lookBackPeriod='DAYS_14'|'DAYS_32'|'DAYS_93',
        utilizationPreferences=[
            {
                'metricName': 'CpuUtilization'|'MemoryUtilization',
                'metricParameters': {
                    'threshold': 'P90'|'P95'|'P99_5',
                    'headroom': 'PERCENT_30'|'PERCENT_20'|'PERCENT_10'|'PERCENT_0'
                }
            },
        ],
        preferredResources=[
            {
                'name': 'Ec2InstanceTypes',
                'includeList': [
                    'string',
                ],
                'excludeList': [
                    'string',
                ]
            },
        ],
        savingsEstimationMode='AfterDiscounts'|'BeforeDiscounts'
    )
    
  :type resourceType: string
  :param resourceType: **[REQUIRED]** 

    The target resource type of the recommendation preference to create.

     

    The ``Ec2Instance`` option encompasses standalone instances and instances that are part of Amazon EC2 Auto Scaling groups. The ``AutoScalingGroup`` option encompasses only instances that are part of an Amazon EC2 Auto Scaling group.

    

  
  :type scope: dict
  :param scope: 

    An object that describes the scope of the recommendation preference to create.

     

    You can create recommendation preferences at the organization level (for management accounts of an organization only), account level, and resource level. For more information, see `Activating enhanced infrastructure metrics <https://docs.aws.amazon.com/compute-optimizer/latest/ug/enhanced-infrastructure-metrics.html>`__ in the *Compute Optimizer User Guide*.

     

    .. note::

      

      You cannot create recommendation preferences for Amazon EC2 Auto Scaling groups at the organization and account levels. You can create recommendation preferences for Amazon EC2 Auto Scaling groups only at the resource level by specifying a scope name of ``ResourceArn`` and a scope value of the Amazon EC2 Auto Scaling group Amazon Resource Name (ARN). This will configure the preference for all instances that are part of the specified Amazon EC2 Auto Scaling group. You also cannot create recommendation preferences at the resource level for instances that are part of an Amazon EC2 Auto Scaling group. You can create recommendation preferences at the resource level only for standalone instances.

      

    

  
    - **name** *(string) --* 

      The name of the scope.

       

      The following scopes are possible:

       

      
      * ``Organization`` - Specifies that the recommendation preference applies at the organization level, for all member accounts of an organization.
       
      * ``AccountId`` - Specifies that the recommendation preference applies at the account level, for all resources of a given resource type in an account.
       
      * ``ResourceArn`` - Specifies that the recommendation preference applies at the individual resource level.
      

      

    
    - **value** *(string) --* 

      The value of the scope.

       

      If you specified the ``name`` of the scope as:

       

      
      * ``Organization`` - The ``value`` must be ``ALL_ACCOUNTS``.
       
      * ``AccountId`` - The ``value`` must be a 12-digit Amazon Web Services account ID.
       
      * ``ResourceArn`` - The ``value`` must be the Amazon Resource Name (ARN) of an EC2 instance or an Amazon EC2 Auto Scaling group.
      

       

      Only EC2 instance and Amazon EC2 Auto Scaling group ARNs are currently supported.

      

    
  
  :type enhancedInfrastructureMetrics: string
  :param enhancedInfrastructureMetrics: 

    The status of the enhanced infrastructure metrics recommendation preference to create or update.

     

    Specify the ``Active`` status to activate the preference, or specify ``Inactive`` to deactivate the preference.

     

    For more information, see `Enhanced infrastructure metrics <https://docs.aws.amazon.com/compute-optimizer/latest/ug/enhanced-infrastructure-metrics.html>`__ in the *Compute Optimizer User Guide*.

    

  
  :type inferredWorkloadTypes: string
  :param inferredWorkloadTypes: 

    The status of the inferred workload types recommendation preference to create or update.

     

    .. note::

      

      The inferred workload type feature is active by default. To deactivate it, create a recommendation preference.

      

     

    Specify the ``Inactive`` status to deactivate the feature, or specify ``Active`` to activate it.

     

    For more information, see `Inferred workload types <https://docs.aws.amazon.com/compute-optimizer/latest/ug/inferred-workload-types.html>`__ in the *Compute Optimizer User Guide*.

    

  
  :type externalMetricsPreference: dict
  :param externalMetricsPreference: 

    The provider of the external metrics recommendation preference to create or update.

     

    Specify a valid provider in the ``source`` field to activate the preference. To delete this preference, see the  DeleteRecommendationPreferences action.

     

    This preference can only be set for the ``Ec2Instance`` resource type.

     

    For more information, see `External metrics ingestion <https://docs.aws.amazon.com/compute-optimizer/latest/ug/external-metrics-ingestion.html>`__ in the *Compute Optimizer User Guide*.

    

  
    - **source** *(string) --* 

      Contains the source options for external metrics preferences.

      

    
  
  :type lookBackPeriod: string
  :param lookBackPeriod: 

    The preference to control the number of days the utilization metrics of the Amazon Web Services resource are analyzed. When this preference isn't specified, we use the default value ``DAYS_14``.

     

    You can only set this preference for the Amazon EC2 instance and Amazon EC2 Auto Scaling group resource types.

     

    .. note::

      

      
      * Amazon EC2 instance lookback preferences can be set at the organization, account, and resource levels.
       
      * Amazon EC2 Auto Scaling group lookback preferences can only be set at the resource level.
      

      

    

  
  :type utilizationPreferences: list
  :param utilizationPreferences: 

    The preference to control the resource’s CPU utilization threshold, CPU utilization headroom, and memory utilization headroom. When this preference isn't specified, we use the following default values.

     

    CPU utilization:

     

    
    * ``P99_5`` for threshold
     
    * ``PERCENT_20`` for headroom
    

     

    Memory utilization:

     

    
    * ``PERCENT_20`` for headroom
    

     

    .. note::

      

      
      * You can only set CPU and memory utilization preferences for the Amazon EC2 instance resource type.
       
      * The threshold setting isn’t available for memory utilization.
      

      

    

  
    - *(dict) --* 

      The preference to control the resource’s CPU utilization threshold, CPU utilization headroom, and memory utilization headroom.

       

      .. note::

        

        This preference is only available for the Amazon EC2 instance resource type.

        

      

    
      - **metricName** *(string) --* 

        The name of the resource utilization metric name to customize.

        

      
      - **metricParameters** *(dict) --* 

        The parameters to set when customizing the resource utilization thresholds.

        

      
        - **threshold** *(string) --* 

          The threshold value used for the specified metric parameter.

           

          .. note::

            

            You can only specify the threshold value for CPU utilization.

            

          

        
        - **headroom** *(string) --* 

          The headroom value in percentage used for the specified metric parameter.

           

          The following lists the valid values for CPU and memory utilization.

           

          
          * CPU utilization: ``PERCENT_30 | PERCENT_20 | PERCENT_0``
           
          * Memory utilization: ``PERCENT_30 | PERCENT_20 | PERCENT_10``
          

          

        
      
    

  :type preferredResources: list
  :param preferredResources: 

    The preference to control which resource type values are considered when generating rightsizing recommendations. You can specify this preference as a combination of include and exclude lists. You must specify either an ``includeList`` or ``excludeList``. If the preference is an empty set of resource type values, an error occurs.

     

    .. note::

      

      You can only set this preference for the Amazon EC2 instance and Amazon EC2 Auto Scaling group resource types.

      

    

  
    - *(dict) --* 

      The preference to control which resource type values are considered when generating rightsizing recommendations. You can specify this preference as a combination of include and exclude lists. You must specify either an ``includeList`` or ``excludeList``. If the preference is an empty set of resource type values, an error occurs. For more information, see `Rightsizing recommendation preferences <https://docs.aws.amazon.com/compute-optimizer/latest/ug/rightsizing-preferences.html>`__ in the *Compute Optimizer User Guide*.

       

      .. note::

        

        
        * This preference is only available for the Amazon EC2 instance and Amazon EC2 Auto Scaling group resource types.
         
        * Compute Optimizer only supports the customization of ``Ec2InstanceTypes``.
        

        

      

    
      - **name** *(string) --* 

        The type of preferred resource to customize.

         

        .. note::

          

          Compute Optimizer only supports the customization of ``Ec2InstanceTypes``.

          

        

      
      - **includeList** *(list) --* 

        The preferred resource type values to include in the recommendation candidates. You can specify the exact resource type value, such as m5.large, or use wild card expressions, such as m5. If this isn’t specified, all supported resources are included by default. You can specify up to 1000 values in this list.

        

      
        - *(string) --* 

        
    
      - **excludeList** *(list) --* 

        The preferred resource type values to exclude from the recommendation candidates. If this isn’t specified, all supported resources are included by default. You can specify up to 1000 values in this list.

        

      
        - *(string) --* 

        
    
    

  :type savingsEstimationMode: string
  :param savingsEstimationMode: 

    The status of the savings estimation mode preference to create or update.

     

    Specify the ``AfterDiscounts`` status to activate the preference, or specify ``BeforeDiscounts`` to deactivate the preference.

     

    Only the account manager or delegated administrator of your organization can activate this preference.

     

    For more information, see `Savings estimation mode <https://docs.aws.amazon.com/compute-optimizer/latest/ug/savings-estimation-mode.html>`__ in the *Compute Optimizer User Guide*.

    

  
  
  :rtype: dict
  :returns: 
    
    **Response Syntax**

    
    ::

      {}
      
    **Response Structure**

    

    - *(dict) --* 
  
  **Exceptions**
  
  *   :py:class:`ComputeOptimizer.Client.exceptions.OptInRequiredException`

  
  *   :py:class:`ComputeOptimizer.Client.exceptions.InternalServerException`

  
  *   :py:class:`ComputeOptimizer.Client.exceptions.ServiceUnavailableException`

  
  *   :py:class:`ComputeOptimizer.Client.exceptions.AccessDeniedException`

  
  *   :py:class:`ComputeOptimizer.Client.exceptions.InvalidParameterValueException`

  
  *   :py:class:`ComputeOptimizer.Client.exceptions.ResourceNotFoundException`

  
  *   :py:class:`ComputeOptimizer.Client.exceptions.MissingAuthenticationToken`

  
  *   :py:class:`ComputeOptimizer.Client.exceptions.ThrottlingException`

  