:doc:`GuardDuty <../../guardduty>` / Client / update_detector

***************
update_detector
***************



.. py:method:: GuardDuty.Client.update_detector(**kwargs)

  

  Updates the GuardDuty detector specified by the detector ID.

   

  Specifying both EKS Runtime Monitoring ( ``EKS_RUNTIME_MONITORING``) and Runtime Monitoring ( ``RUNTIME_MONITORING``) will cause an error. You can add only one of these two features because Runtime Monitoring already includes the threat detection for Amazon EKS resources. For more information, see `Runtime Monitoring <https://docs.aws.amazon.com/guardduty/latest/ug/runtime-monitoring.html>`__.

   

  There might be regional differences because some data sources might not be available in all the Amazon Web Services Regions where GuardDuty is presently supported. For more information, see `Regions and endpoints <https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_regions.html>`__.

  

  See also: `AWS API Documentation <https://docs.aws.amazon.com/goto/WebAPI/guardduty-2017-11-28/UpdateDetector>`_  


  **Request Syntax**
  ::

    response = client.update_detector(
        DetectorId='string',
        Enable=True|False,
        FindingPublishingFrequency='FIFTEEN_MINUTES'|'ONE_HOUR'|'SIX_HOURS',
        DataSources={
            'S3Logs': {
                'Enable': True|False
            },
            'Kubernetes': {
                'AuditLogs': {
                    'Enable': True|False
                }
            },
            'MalwareProtection': {
                'ScanEc2InstanceWithFindings': {
                    'EbsVolumes': True|False
                }
            }
        },
        Features=[
            {
                'Name': 'S3_DATA_EVENTS'|'EKS_AUDIT_LOGS'|'EBS_MALWARE_PROTECTION'|'RDS_LOGIN_EVENTS'|'EKS_RUNTIME_MONITORING'|'LAMBDA_NETWORK_LOGS'|'RUNTIME_MONITORING',
                'Status': 'ENABLED'|'DISABLED',
                'AdditionalConfiguration': [
                    {
                        'Name': 'EKS_ADDON_MANAGEMENT'|'ECS_FARGATE_AGENT_MANAGEMENT'|'EC2_AGENT_MANAGEMENT',
                        'Status': 'ENABLED'|'DISABLED'
                    },
                ]
            },
        ]
    )
    
  :type DetectorId: string
  :param DetectorId: **[REQUIRED]** 

    The unique ID of the detector to update.

     

    To find the ``detectorId`` in the current Region, see the Settings page in the GuardDuty console, or run the `ListDetectors <https://docs.aws.amazon.com/guardduty/latest/APIReference/API_ListDetectors.html>`__ API.

    

  
  :type Enable: boolean
  :param Enable: 

    Specifies whether the detector is enabled or not enabled.

    

  
  :type FindingPublishingFrequency: string
  :param FindingPublishingFrequency: 

    An enum value that specifies how frequently findings are exported, such as to CloudWatch Events.

    

  
  :type DataSources: dict
  :param DataSources: 

    Describes which data sources will be updated.

     

    There might be regional differences because some data sources might not be available in all the Amazon Web Services Regions where GuardDuty is presently supported. For more information, see `Regions and endpoints <https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_regions.html>`__.

    

  
    - **S3Logs** *(dict) --* 

      Describes whether S3 data event logs are enabled as a data source.

      

    
      - **Enable** *(boolean) --* **[REQUIRED]** 

        The status of S3 data event logs as a data source.

        

      
    
    - **Kubernetes** *(dict) --* 

      Describes whether any Kubernetes logs are enabled as data sources.

      

    
      - **AuditLogs** *(dict) --* **[REQUIRED]** 

        The status of Kubernetes audit logs as a data source.

        

      
        - **Enable** *(boolean) --* **[REQUIRED]** 

          The status of Kubernetes audit logs as a data source.

          

        
      
    
    - **MalwareProtection** *(dict) --* 

      Describes whether Malware Protection is enabled as a data source.

      

    
      - **ScanEc2InstanceWithFindings** *(dict) --* 

        Describes the configuration of Malware Protection for EC2 instances with findings.

        

      
        - **EbsVolumes** *(boolean) --* 

          Describes the configuration for scanning EBS volumes as data source.

          

        
      
    
  
  :type Features: list
  :param Features: 

    Provides the features that will be updated for the detector.

    

  
    - *(dict) --* 

      Contains information about a GuardDuty feature.

       

      Specifying both EKS Runtime Monitoring ( ``EKS_RUNTIME_MONITORING``) and Runtime Monitoring ( ``RUNTIME_MONITORING``) will cause an error. You can add only one of these two features because Runtime Monitoring already includes the threat detection for Amazon EKS resources. For more information, see `Runtime Monitoring <https://docs.aws.amazon.com/guardduty/latest/ug/runtime-monitoring.html>`__.

      

    
      - **Name** *(string) --* 

        The name of the feature.

        

      
      - **Status** *(string) --* 

        The status of the feature.

        

      
      - **AdditionalConfiguration** *(list) --* 

        Additional configuration for a resource.

        

      
        - *(dict) --* 

          Information about the additional configuration for a feature in your GuardDuty account.

          

        
          - **Name** *(string) --* 

            Name of the additional configuration.

            

          
          - **Status** *(string) --* 

            Status of the additional configuration.

            

          
        
    
    

  
  :rtype: dict
  :returns: 
    
    **Response Syntax**

    
    ::

      {}
      
    **Response Structure**

    

    - *(dict) --* 
  
  **Exceptions**
  
  *   :py:class:`GuardDuty.Client.exceptions.BadRequestException`

  
  *   :py:class:`GuardDuty.Client.exceptions.InternalServerErrorException`

  