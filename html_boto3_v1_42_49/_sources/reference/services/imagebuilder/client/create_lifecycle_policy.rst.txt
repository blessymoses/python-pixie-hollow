:doc:`imagebuilder <../../imagebuilder>` / Client / create_lifecycle_policy

***********************
create_lifecycle_policy
***********************



.. py:method:: imagebuilder.Client.create_lifecycle_policy(**kwargs)

  

  Create a lifecycle policy resource.

  

  See also: `AWS API Documentation <https://docs.aws.amazon.com/goto/WebAPI/imagebuilder-2019-12-02/CreateLifecyclePolicy>`_  


  **Request Syntax**
  ::

    response = client.create_lifecycle_policy(
        name='string',
        description='string',
        status='DISABLED'|'ENABLED',
        executionRole='string',
        resourceType='AMI_IMAGE'|'CONTAINER_IMAGE',
        policyDetails=[
            {
                'action': {
                    'type': 'DELETE'|'DEPRECATE'|'DISABLE',
                    'includeResources': {
                        'amis': True|False,
                        'snapshots': True|False,
                        'containers': True|False
                    }
                },
                'filter': {
                    'type': 'AGE'|'COUNT',
                    'value': 123,
                    'unit': 'DAYS'|'WEEKS'|'MONTHS'|'YEARS',
                    'retainAtLeast': 123
                },
                'exclusionRules': {
                    'tagMap': {
                        'string': 'string'
                    },
                    'amis': {
                        'isPublic': True|False,
                        'regions': [
                            'string',
                        ],
                        'sharedAccounts': [
                            'string',
                        ],
                        'lastLaunched': {
                            'value': 123,
                            'unit': 'DAYS'|'WEEKS'|'MONTHS'|'YEARS'
                        },
                        'tagMap': {
                            'string': 'string'
                        }
                    }
                }
            },
        ],
        resourceSelection={
            'recipes': [
                {
                    'name': 'string',
                    'semanticVersion': 'string'
                },
            ],
            'tagMap': {
                'string': 'string'
            }
        },
        tags={
            'string': 'string'
        },
        clientToken='string'
    )
    
  :type name: string
  :param name: **[REQUIRED]** 

    The name of the lifecycle policy to create.

    

  
  :type description: string
  :param description: 

    Optional description for the lifecycle policy.

    

  
  :type status: string
  :param status: 

    Indicates whether the lifecycle policy resource is enabled.

    

  
  :type executionRole: string
  :param executionRole: **[REQUIRED]** 

    The name or Amazon Resource Name (ARN) for the IAM role you create that grants Image Builder access to run lifecycle actions.

    

  
  :type resourceType: string
  :param resourceType: **[REQUIRED]** 

    The type of Image Builder resource that the lifecycle policy applies to.

    

  
  :type policyDetails: list
  :param policyDetails: **[REQUIRED]** 

    Configuration details for the lifecycle policy rules.

    

  
    - *(dict) --* 

      The configuration details for a lifecycle policy resource.

      

    
      - **action** *(dict) --* **[REQUIRED]** 

        Configuration details for the policy action.

        

      
        - **type** *(string) --* **[REQUIRED]** 

          Specifies the lifecycle action to take.

          

        
        - **includeResources** *(dict) --* 

          Specifies the resources that the lifecycle policy applies to.

          

        
          - **amis** *(boolean) --* 

            Specifies whether the lifecycle action should apply to distributed AMIs.

            

          
          - **snapshots** *(boolean) --* 

            Specifies whether the lifecycle action should apply to snapshots associated with distributed AMIs.

            

          
          - **containers** *(boolean) --* 

            Specifies whether the lifecycle action should apply to distributed containers.

            

          
        
      
      - **filter** *(dict) --* **[REQUIRED]** 

        Specifies the resources that the lifecycle policy applies to.

        

      
        - **type** *(string) --* **[REQUIRED]** 

          Filter resources based on either ``age`` or ``count``.

          

        
        - **value** *(integer) --* **[REQUIRED]** 

          The number of units for the time period or for the count. For example, a value of ``6`` might refer to six months or six AMIs.

           

          .. note::

            

            For count-based filters, this value represents the minimum number of resources to keep on hand. If you have fewer resources than this number, the resource is excluded from lifecycle actions.

            

          

        
        - **unit** *(string) --* 

          Defines the unit of time that the lifecycle policy uses to determine impacted resources. This is required for age-based rules.

          

        
        - **retainAtLeast** *(integer) --* 

          For age-based filters, this is the number of resources to keep on hand after the lifecycle ``DELETE`` action is applied. Impacted resources are only deleted if you have more than this number of resources. If you have fewer resources than this number, the impacted resource is not deleted.

          

        
      
      - **exclusionRules** *(dict) --* 

        Additional rules to specify resources that should be exempt from policy actions.

        

      
        - **tagMap** *(dict) --* 

          Contains a list of tags that Image Builder uses to skip lifecycle actions for Image Builder image resources that have them.

          

        
          - *(string) --* 

          
            - *(string) --* 

            
      
    
        - **amis** *(dict) --* 

          Lists configuration values that apply to AMIs that Image Builder should exclude from the lifecycle action.

          

        
          - **isPublic** *(boolean) --* 

            Configures whether public AMIs are excluded from the lifecycle action.

            

          
          - **regions** *(list) --* 

            Configures Amazon Web Services Regions that are excluded from the lifecycle action.

            

          
            - *(string) --* 

            
        
          - **sharedAccounts** *(list) --* 

            Specifies Amazon Web Services accounts whose resources are excluded from the lifecycle action.

            

          
            - *(string) --* 

            
        
          - **lastLaunched** *(dict) --* 

            Specifies configuration details for Image Builder to exclude the most recent resources from lifecycle actions.

            

          
            - **value** *(integer) --* **[REQUIRED]** 

              The integer number of units for the time period. For example ``6`` (months).

              

            
            - **unit** *(string) --* **[REQUIRED]** 

              Defines the unit of time that the lifecycle policy uses to calculate elapsed time since the last instance launched from the AMI. For example: days, weeks, months, or years.

              

            
          
          - **tagMap** *(dict) --* 

            Lists tags that should be excluded from lifecycle actions for the AMIs that have them.

            

          
            - *(string) --* 

            
              - *(string) --* 

              
        
      
        
      
    

  :type resourceSelection: dict
  :param resourceSelection: **[REQUIRED]** 

    Selection criteria for the resources that the lifecycle policy applies to.

    

  
    - **recipes** *(list) --* 

      A list of recipes that are used as selection criteria for the output images that the lifecycle policy applies to.

      

    
      - *(dict) --* 

        Specifies an Image Builder recipe that the lifecycle policy uses for resource selection.

        

      
        - **name** *(string) --* **[REQUIRED]** 

          The name of an Image Builder recipe that the lifecycle policy uses for resource selection.

          

        
        - **semanticVersion** *(string) --* **[REQUIRED]** 

          The version of the Image Builder recipe specified by the ``name`` field.

          

        
      
  
    - **tagMap** *(dict) --* 

      A list of tags that are used as selection criteria for the Image Builder image resources that the lifecycle policy applies to.

      

    
      - *(string) --* 

      
        - *(string) --* 

        
  

  
  :type tags: dict
  :param tags: 

    Tags to apply to the lifecycle policy resource.

    

  
    - *(string) --* 

    
      - *(string) --* 

      


  :type clientToken: string
  :param clientToken: **[REQUIRED]** 

    Unique, case-sensitive identifier you provide to ensure idempotency of the request. For more information, see `Ensuring idempotency <https://docs.aws.amazon.com/AWSEC2/latest/APIReference/Run_Instance_Idempotency.html>`__ in the *Amazon EC2 API Reference*.

    This field is autopopulated if not provided.

  
  
  :rtype: dict
  :returns: 
    
    **Response Syntax**

    
    ::

      {
          'clientToken': 'string',
          'lifecyclePolicyArn': 'string'
      }
      
    **Response Structure**

    

    - *(dict) --* 
      

      - **clientToken** *(string) --* 

        The client token that uniquely identifies the request.

        
      

      - **lifecyclePolicyArn** *(string) --* 

        The Amazon Resource Name (ARN) of the lifecycle policy that the request created.

        
  
  **Exceptions**
  
  *   :py:class:`imagebuilder.Client.exceptions.ServiceException`

  
  *   :py:class:`imagebuilder.Client.exceptions.ClientException`

  
  *   :py:class:`imagebuilder.Client.exceptions.ServiceUnavailableException`

  
  *   :py:class:`imagebuilder.Client.exceptions.InvalidRequestException`

  
  *   :py:class:`imagebuilder.Client.exceptions.IdempotentParameterMismatchException`

  
  *   :py:class:`imagebuilder.Client.exceptions.ForbiddenException`

  
  *   :py:class:`imagebuilder.Client.exceptions.CallRateLimitExceededException`

  
  *   :py:class:`imagebuilder.Client.exceptions.ResourceInUseException`

  
  *   :py:class:`imagebuilder.Client.exceptions.ResourceAlreadyExistsException`

  
  *   :py:class:`imagebuilder.Client.exceptions.ServiceQuotaExceededException`

  