:doc:`Athena <../../athena>` / Client / batch_get_query_execution

*************************
batch_get_query_execution
*************************



.. py:method:: Athena.Client.batch_get_query_execution(**kwargs)

  

  Returns the details of a single query execution or a list of up to 50 query executions, which you provide as an array of query execution ID strings. Requires you to have access to the workgroup in which the queries ran. To get a list of query execution IDs, use  ListQueryExecutionsInput$WorkGroup. Query executions differ from named (saved) queries. Use  BatchGetNamedQueryInput to get details about named queries.

  

  See also: `AWS API Documentation <https://docs.aws.amazon.com/goto/WebAPI/athena-2017-05-18/BatchGetQueryExecution>`_  


  **Request Syntax**
  ::

    response = client.batch_get_query_execution(
        QueryExecutionIds=[
            'string',
        ]
    )
    
  :type QueryExecutionIds: list
  :param QueryExecutionIds: **[REQUIRED]** 

    An array of query execution IDs.

    

  
    - *(string) --* 

    

  
  :rtype: dict
  :returns: 
    
    **Response Syntax**

    
    ::

      {
          'QueryExecutions': [
              {
                  'QueryExecutionId': 'string',
                  'Query': 'string',
                  'StatementType': 'DDL'|'DML'|'UTILITY',
                  'ManagedQueryResultsConfiguration': {
                      'Enabled': True|False,
                      'EncryptionConfiguration': {
                          'KmsKey': 'string'
                      }
                  },
                  'ResultConfiguration': {
                      'OutputLocation': 'string',
                      'EncryptionConfiguration': {
                          'EncryptionOption': 'SSE_S3'|'SSE_KMS'|'CSE_KMS',
                          'KmsKey': 'string'
                      },
                      'ExpectedBucketOwner': 'string',
                      'AclConfiguration': {
                          'S3AclOption': 'BUCKET_OWNER_FULL_CONTROL'
                      }
                  },
                  'ResultReuseConfiguration': {
                      'ResultReuseByAgeConfiguration': {
                          'Enabled': True|False,
                          'MaxAgeInMinutes': 123
                      }
                  },
                  'QueryExecutionContext': {
                      'Database': 'string',
                      'Catalog': 'string'
                  },
                  'Status': {
                      'State': 'QUEUED'|'RUNNING'|'SUCCEEDED'|'FAILED'|'CANCELLED',
                      'StateChangeReason': 'string',
                      'SubmissionDateTime': datetime(2015, 1, 1),
                      'CompletionDateTime': datetime(2015, 1, 1),
                      'AthenaError': {
                          'ErrorCategory': 123,
                          'ErrorType': 123,
                          'Retryable': True|False,
                          'ErrorMessage': 'string'
                      }
                  },
                  'Statistics': {
                      'EngineExecutionTimeInMillis': 123,
                      'DataScannedInBytes': 123,
                      'DataManifestLocation': 'string',
                      'TotalExecutionTimeInMillis': 123,
                      'QueryQueueTimeInMillis': 123,
                      'ServicePreProcessingTimeInMillis': 123,
                      'QueryPlanningTimeInMillis': 123,
                      'ServiceProcessingTimeInMillis': 123,
                      'ResultReuseInformation': {
                          'ReusedPreviousResult': True|False
                      },
                      'DpuCount': 123.0
                  },
                  'WorkGroup': 'string',
                  'EngineVersion': {
                      'SelectedEngineVersion': 'string',
                      'EffectiveEngineVersion': 'string'
                  },
                  'ExecutionParameters': [
                      'string',
                  ],
                  'SubstatementType': 'string',
                  'QueryResultsS3AccessGrantsConfiguration': {
                      'EnableS3AccessGrants': True|False,
                      'CreateUserLevelPrefix': True|False,
                      'AuthenticationType': 'DIRECTORY_IDENTITY'
                  }
              },
          ],
          'UnprocessedQueryExecutionIds': [
              {
                  'QueryExecutionId': 'string',
                  'ErrorCode': 'string',
                  'ErrorMessage': 'string'
              },
          ]
      }
      
    **Response Structure**

    

    - *(dict) --* 
      

      - **QueryExecutions** *(list) --* 

        Information about a query execution.

        
        

        - *(dict) --* 

          Information about a single instance of a query execution.

          
          

          - **QueryExecutionId** *(string) --* 

            The unique identifier for each query execution.

            
          

          - **Query** *(string) --* 

            The SQL query statements which the query execution ran.

            
          

          - **StatementType** *(string) --* 

            The type of query statement that was run. ``DDL`` indicates DDL query statements. ``DML`` indicates DML (Data Manipulation Language) query statements, such as ``CREATE TABLE AS SELECT``. ``UTILITY`` indicates query statements other than DDL and DML, such as ``SHOW CREATE TABLE``, ``EXPLAIN``, ``DESCRIBE``, or ``SHOW TABLES``.

            
          

          - **ManagedQueryResultsConfiguration** *(dict) --* 

            The configuration for storing results in Athena owned storage, which includes whether this feature is enabled; whether encryption configuration, if any, is used for encrypting query results.

            
            

            - **Enabled** *(boolean) --* 

              If set to true, allows you to store query results in Athena owned storage. If set to false, workgroup member stores query results in location specified under ``ResultConfiguration$OutputLocation``. The default is false. A workgroup cannot have the ``ResultConfiguration$OutputLocation`` parameter when you set this field to true.

              
            

            - **EncryptionConfiguration** *(dict) --* 

              If you encrypt query and calculation results in Athena owned storage, this field indicates the encryption option (for example, SSE_KMS or CSE_KMS) and key information.

              
              

              - **KmsKey** *(string) --* 

                The ARN of an KMS key for encrypting managed query results.

                
          
        
          

          - **ResultConfiguration** *(dict) --* 

            The location in Amazon S3 where query and calculation results are stored and the encryption option, if any, used for query results. These are known as "client-side settings". If workgroup settings override client-side settings, then the query uses the location for the query results and the encryption configuration that are specified for the workgroup.

            
            

            - **OutputLocation** *(string) --* 

              The location in Amazon S3 where your query and calculation results are stored, such as ``s3://path/to/query/bucket/``. To run the query, you must specify the query results location using one of the ways: either for individual queries using either this setting (client-side), or in the workgroup, using  WorkGroupConfiguration. If none of them is set, Athena issues an error that no output location is provided. If workgroup settings override client-side settings, then the query uses the settings specified for the workgroup. See  WorkGroupConfiguration$EnforceWorkGroupConfiguration.

              
            

            - **EncryptionConfiguration** *(dict) --* 

              If query and calculation results are encrypted in Amazon S3, indicates the encryption option used (for example, ``SSE_KMS`` or ``CSE_KMS``) and key information. This is a client-side setting. If workgroup settings override client-side settings, then the query uses the encryption configuration that is specified for the workgroup, and also uses the location for storing query results specified in the workgroup. See  WorkGroupConfiguration$EnforceWorkGroupConfiguration and `Workgroup Settings Override Client-Side Settings <https://docs.aws.amazon.com/athena/latest/ug/workgroups-settings-override.html>`__.

              
              

              - **EncryptionOption** *(string) --* 

                Indicates whether Amazon S3 server-side encryption with Amazon S3-managed keys ( ``SSE_S3``), server-side encryption with KMS-managed keys ( ``SSE_KMS``), or client-side encryption with KMS-managed keys ( ``CSE_KMS``) is used.

                 

                If a query runs in a workgroup and the workgroup overrides client-side settings, then the workgroup's setting for encryption is used. It specifies whether query results must be encrypted, for all queries that run in this workgroup.

                
              

              - **KmsKey** *(string) --* 

                For ``SSE_KMS`` and ``CSE_KMS``, this is the KMS key ARN or ID.

                
          
            

            - **ExpectedBucketOwner** *(string) --* 

              The Amazon Web Services account ID that you expect to be the owner of the Amazon S3 bucket specified by  ResultConfiguration$OutputLocation. If set, Athena uses the value for ``ExpectedBucketOwner`` when it makes Amazon S3 calls to your specified output location. If the ``ExpectedBucketOwner`` Amazon Web Services account ID does not match the actual owner of the Amazon S3 bucket, the call fails with a permissions error.

               

              This is a client-side setting. If workgroup settings override client-side settings, then the query uses the ``ExpectedBucketOwner`` setting that is specified for the workgroup, and also uses the location for storing query results specified in the workgroup. See  WorkGroupConfiguration$EnforceWorkGroupConfiguration and `Workgroup Settings Override Client-Side Settings <https://docs.aws.amazon.com/athena/latest/ug/workgroups-settings-override.html>`__.

              
            

            - **AclConfiguration** *(dict) --* 

              Indicates that an Amazon S3 canned ACL should be set to control ownership of stored query results. Currently the only supported canned ACL is ``BUCKET_OWNER_FULL_CONTROL``. This is a client-side setting. If workgroup settings override client-side settings, then the query uses the ACL configuration that is specified for the workgroup, and also uses the location for storing query results specified in the workgroup. For more information, see  WorkGroupConfiguration$EnforceWorkGroupConfiguration and `Workgroup Settings Override Client-Side Settings <https://docs.aws.amazon.com/athena/latest/ug/workgroups-settings-override.html>`__.

              
              

              - **S3AclOption** *(string) --* 

                The Amazon S3 canned ACL that Athena should specify when storing query results, including data files inserted by Athena as the result of statements like CTAS or INSERT INTO. Currently the only supported canned ACL is ``BUCKET_OWNER_FULL_CONTROL``. If a query runs in a workgroup and the workgroup overrides client-side settings, then the Amazon S3 canned ACL specified in the workgroup's settings is used for all queries that run in the workgroup. For more information about Amazon S3 canned ACLs, see `Canned ACL <https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl>`__ in the *Amazon S3 User Guide*.

                
          
        
          

          - **ResultReuseConfiguration** *(dict) --* 

            Specifies the query result reuse behavior that was used for the query.

            
            

            - **ResultReuseByAgeConfiguration** *(dict) --* 

              Specifies whether previous query results are reused, and if so, their maximum age.

              
              

              - **Enabled** *(boolean) --* 

                True if previous query results can be reused when the query is run; otherwise, false. The default is false.

                
              

              - **MaxAgeInMinutes** *(integer) --* 

                Specifies, in minutes, the maximum age of a previous query result that Athena should consider for reuse. The default is 60.

                
          
        
          

          - **QueryExecutionContext** *(dict) --* 

            The database in which the query execution occurred.

            
            

            - **Database** *(string) --* 

              The name of the database used in the query execution. The database must exist in the catalog.

              
            

            - **Catalog** *(string) --* 

              The name of the data catalog used in the query execution.

              
        
          

          - **Status** *(dict) --* 

            The completion date, current state, submission time, and state change reason (if applicable) for the query execution.

            
            

            - **State** *(string) --* 

              The state of query execution. ``QUEUED`` indicates that the query has been submitted to the service, and Athena will execute the query as soon as resources are available. ``RUNNING`` indicates that the query is in execution phase. ``SUCCEEDED`` indicates that the query completed without errors. ``FAILED`` indicates that the query experienced an error and did not complete processing. ``CANCELLED`` indicates that a user input interrupted query execution.

               

              .. note::

                

                For queries that experience certain transient errors, the state transitions from ``RUNNING`` back to ``QUEUED``. The ``FAILED`` state is always terminal with no automatic retry.

                

              
            

            - **StateChangeReason** *(string) --* 

              Further detail about the status of the query.

              
            

            - **SubmissionDateTime** *(datetime) --* 

              The date and time that the query was submitted.

              
            

            - **CompletionDateTime** *(datetime) --* 

              The date and time that the query completed.

              
            

            - **AthenaError** *(dict) --* 

              Provides information about an Athena query error.

              
              

              - **ErrorCategory** *(integer) --* 

                An integer value that specifies the category of a query failure error. The following list shows the category for each integer value.

                 

                **1** - System

                 

                **2** - User

                 

                **3** - Other

                
              

              - **ErrorType** *(integer) --* 

                An integer value that provides specific information about an Athena query error. For the meaning of specific values, see the `Error Type Reference <https://docs.aws.amazon.com/athena/latest/ug/error-reference.html#error-reference-error-type-reference>`__ in the *Amazon Athena User Guide*.

                
              

              - **Retryable** *(boolean) --* 

                True if the query might succeed if resubmitted.

                
              

              - **ErrorMessage** *(string) --* 

                Contains a short description of the error that occurred.

                
          
        
          

          - **Statistics** *(dict) --* 

            Query execution statistics, such as the amount of data scanned, the amount of time that the query took to process, and the type of statement that was run.

            
            

            - **EngineExecutionTimeInMillis** *(integer) --* 

              The number of milliseconds that the query took to execute.

              
            

            - **DataScannedInBytes** *(integer) --* 

              The number of bytes in the data that was queried.

              
            

            - **DataManifestLocation** *(string) --* 

              The location and file name of a data manifest file. The manifest file is saved to the Athena query results location in Amazon S3. The manifest file tracks files that the query wrote to Amazon S3. If the query fails, the manifest file also tracks files that the query intended to write. The manifest is useful for identifying orphaned files resulting from a failed query. For more information, see `Working with Query Results, Output Files, and Query History <https://docs.aws.amazon.com/athena/latest/ug/querying.html>`__ in the *Amazon Athena User Guide*.

              
            

            - **TotalExecutionTimeInMillis** *(integer) --* 

              The number of milliseconds that Athena took to run the query.

              
            

            - **QueryQueueTimeInMillis** *(integer) --* 

              The number of milliseconds that the query was in your query queue waiting for resources. Note that if transient errors occur, Athena might automatically add the query back to the queue.

              
            

            - **ServicePreProcessingTimeInMillis** *(integer) --* 

              The number of milliseconds that Athena took to preprocess the query before submitting the query to the query engine.

              
            

            - **QueryPlanningTimeInMillis** *(integer) --* 

              The number of milliseconds that Athena took to plan the query processing flow. This includes the time spent retrieving table partitions from the data source. Note that because the query engine performs the query planning, query planning time is a subset of engine processing time.

              
            

            - **ServiceProcessingTimeInMillis** *(integer) --* 

              The number of milliseconds that Athena took to finalize and publish the query results after the query engine finished running the query.

              
            

            - **ResultReuseInformation** *(dict) --* 

              Contains information about whether previous query results were reused for the query.

              
              

              - **ReusedPreviousResult** *(boolean) --* 

                True if a previous query result was reused; false if the result was generated from a new run of the query.

                
          
            

            - **DpuCount** *(float) --* 

              The number of Data Processing Units (DPUs) that Athena used to run the query.

              
        
          

          - **WorkGroup** *(string) --* 

            The name of the workgroup in which the query ran.

            
          

          - **EngineVersion** *(dict) --* 

            The engine version that executed the query.

            
            

            - **SelectedEngineVersion** *(string) --* 

              The engine version requested by the user. Possible values are determined by the output of ``ListEngineVersions``, including AUTO. The default is AUTO.

              
            

            - **EffectiveEngineVersion** *(string) --* 

              Read only. The engine version on which the query runs. If the user requests a valid engine version other than Auto, the effective engine version is the same as the engine version that the user requested. If the user requests Auto, the effective engine version is chosen by Athena. When a request to update the engine version is made by a ``CreateWorkGroup`` or ``UpdateWorkGroup`` operation, the ``EffectiveEngineVersion`` field is ignored.

              
        
          

          - **ExecutionParameters** *(list) --* 

            A list of values for the parameters in a query. The values are applied sequentially to the parameters in the query in the order in which the parameters occur. The list of parameters is not returned in the response.

            
            

            - *(string) --* 
        
          

          - **SubstatementType** *(string) --* 

            The kind of query statement that was run.

            
          

          - **QueryResultsS3AccessGrantsConfiguration** *(dict) --* 

            Specifies whether Amazon S3 access grants are enabled for query results.

            
            

            - **EnableS3AccessGrants** *(boolean) --* 

              Specifies whether Amazon S3 access grants are enabled for query results.

              
            

            - **CreateUserLevelPrefix** *(boolean) --* 

              When enabled, appends the user ID as an Amazon S3 path prefix to the query result output location.

              
            

            - **AuthenticationType** *(string) --* 

              The authentication type used for Amazon S3 access grants. Currently, only ``DIRECTORY_IDENTITY`` is supported.

              
        
      
    
      

      - **UnprocessedQueryExecutionIds** *(list) --* 

        Information about the query executions that failed to run.

        
        

        - *(dict) --* 

          Describes a query execution that failed to process.

          
          

          - **QueryExecutionId** *(string) --* 

            The unique identifier of the query execution.

            
          

          - **ErrorCode** *(string) --* 

            The error code returned when the query execution failed to process, if applicable.

            
          

          - **ErrorMessage** *(string) --* 

            The error message returned when the query execution failed to process, if applicable.

            
      
    
  
  **Exceptions**
  
  *   :py:class:`Athena.Client.exceptions.InternalServerException`

  
  *   :py:class:`Athena.Client.exceptions.InvalidRequestException`

  