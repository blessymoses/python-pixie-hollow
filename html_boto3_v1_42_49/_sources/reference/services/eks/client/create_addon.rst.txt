:doc:`EKS <../../eks>` / Client / create_addon

************
create_addon
************



.. py:method:: EKS.Client.create_addon(**kwargs)

  

  Creates an Amazon EKS add-on.

   

  Amazon EKS add-ons help to automate the provisioning and lifecycle management of common operational software for Amazon EKS clusters. For more information, see `Amazon EKS add-ons <https://docs.aws.amazon.com/eks/latest/userguide/eks-add-ons.html>`__ in the *Amazon EKS User Guide*.

  

  See also: `AWS API Documentation <https://docs.aws.amazon.com/goto/WebAPI/eks-2017-11-01/CreateAddon>`_  


  **Request Syntax**
  ::

    response = client.create_addon(
        clusterName='string',
        addonName='string',
        addonVersion='string',
        serviceAccountRoleArn='string',
        resolveConflicts='OVERWRITE'|'NONE'|'PRESERVE',
        clientRequestToken='string',
        tags={
            'string': 'string'
        },
        configurationValues='string',
        podIdentityAssociations=[
            {
                'serviceAccount': 'string',
                'roleArn': 'string'
            },
        ],
        namespaceConfig={
            'namespace': 'string'
        }
    )
    
  :type clusterName: string
  :param clusterName: **[REQUIRED]** 

    The name of your cluster.

    

  
  :type addonName: string
  :param addonName: **[REQUIRED]** 

    The name of the add-on. The name must match one of the names returned by ``DescribeAddonVersions``.

    

  
  :type addonVersion: string
  :param addonVersion: 

    The version of the add-on. The version must match one of the versions returned by `DescribeAddonVersions <https://docs.aws.amazon.com/eks/latest/APIReference/API_DescribeAddonVersions.html>`__.

    

  
  :type serviceAccountRoleArn: string
  :param serviceAccountRoleArn: 

    The Amazon Resource Name (ARN) of an existing IAM role to bind to the add-on's service account. The role must be assigned the IAM permissions required by the add-on. If you don't specify an existing IAM role, then the add-on uses the permissions assigned to the node IAM role. For more information, see `Amazon EKS node IAM role <https://docs.aws.amazon.com/eks/latest/userguide/create-node-role.html>`__ in the *Amazon EKS User Guide*.

     

    .. note::

      

      To specify an existing IAM role, you must have an IAM OpenID Connect (OIDC) provider created for your cluster. For more information, see `Enabling IAM roles for service accounts on your cluster <https://docs.aws.amazon.com/eks/latest/userguide/enable-iam-roles-for-service-accounts.html>`__ in the *Amazon EKS User Guide*.

      

    

  
  :type resolveConflicts: string
  :param resolveConflicts: 

    How to resolve field value conflicts for an Amazon EKS add-on. Conflicts are handled based on the value you choose:

     

    
    * **None** – If the self-managed version of the add-on is installed on your cluster, Amazon EKS doesn't change the value. Creation of the add-on might fail.
     
    * **Overwrite** – If the self-managed version of the add-on is installed on your cluster and the Amazon EKS default value is different than the existing value, Amazon EKS changes the value to the Amazon EKS default value.
     
    * **Preserve** – This is similar to the NONE option. If the self-managed version of the add-on is installed on your cluster Amazon EKS doesn't change the add-on resource properties. Creation of the add-on might fail if conflicts are detected. This option works differently during the update operation. For more information, see `UpdateAddon <https://docs.aws.amazon.com/eks/latest/APIReference/API_UpdateAddon.html>`__.
    

     

    If you don't currently have the self-managed version of the add-on installed on your cluster, the Amazon EKS add-on is installed. Amazon EKS sets all values to default values, regardless of the option that you specify.

    

  
  :type clientRequestToken: string
  :param clientRequestToken: 

    A unique, case-sensitive identifier that you provide to ensure the idempotency of the request.

    This field is autopopulated if not provided.

  
  :type tags: dict
  :param tags: 

    Metadata that assists with categorization and organization. Each tag consists of a key and an optional value. You define both. Tags don't propagate to any other cluster or Amazon Web Services resources.

    

  
    - *(string) --* 

      One part of a key-value pair that make up a tag. A ``key`` is a general label that acts like a category for more specific tag values.

      

    
      - *(string) --* 

        The optional part of a key-value pair that make up a tag. A ``value`` acts as a descriptor within a tag category (key).

        

      


  :type configurationValues: string
  :param configurationValues: 

    The set of configuration values for the add-on that's created. The values that you provide are validated against the schema returned by ``DescribeAddonConfiguration``.

    

  
  :type podIdentityAssociations: list
  :param podIdentityAssociations: 

    An array of EKS Pod Identity associations to be created. Each association maps a Kubernetes service account to an IAM role.

     

    For more information, see `Attach an IAM Role to an Amazon EKS add-on using EKS Pod Identity <https://docs.aws.amazon.com/eks/latest/userguide/add-ons-iam.html>`__ in the *Amazon EKS User Guide*.

    

  
    - *(dict) --* 

      A type of EKS Pod Identity association owned by an Amazon EKS add-on.

       

      Each association maps a role to a service account in a namespace in the cluster.

       

      For more information, see `Attach an IAM Role to an Amazon EKS add-on using EKS Pod Identity <https://docs.aws.amazon.com/eks/latest/userguide/add-ons-iam.html>`__ in the *Amazon EKS User Guide*.

      

    
      - **serviceAccount** *(string) --* **[REQUIRED]** 

        The name of a Kubernetes Service Account.

        

      
      - **roleArn** *(string) --* **[REQUIRED]** 

        The ARN of an IAM Role.

        

      
    

  :type namespaceConfig: dict
  :param namespaceConfig: 

    The namespace configuration for the addon. If specified, this will override the default namespace for the addon.

    

  
    - **namespace** *(string) --* 

      The name of the Kubernetes namespace to install the addon in. Must be a valid RFC 1123 DNS label.

      

    
  
  
  :rtype: dict
  :returns: 
    
    **Response Syntax**

    
    ::

      {
          'addon': {
              'addonName': 'string',
              'clusterName': 'string',
              'status': 'CREATING'|'ACTIVE'|'CREATE_FAILED'|'UPDATING'|'DELETING'|'DELETE_FAILED'|'DEGRADED'|'UPDATE_FAILED',
              'addonVersion': 'string',
              'health': {
                  'issues': [
                      {
                          'code': 'AccessDenied'|'InternalFailure'|'ClusterUnreachable'|'InsufficientNumberOfReplicas'|'ConfigurationConflict'|'AdmissionRequestDenied'|'UnsupportedAddonModification'|'K8sResourceNotFound'|'AddonSubscriptionNeeded'|'AddonPermissionFailure',
                          'message': 'string',
                          'resourceIds': [
                              'string',
                          ]
                      },
                  ]
              },
              'addonArn': 'string',
              'createdAt': datetime(2015, 1, 1),
              'modifiedAt': datetime(2015, 1, 1),
              'serviceAccountRoleArn': 'string',
              'tags': {
                  'string': 'string'
              },
              'publisher': 'string',
              'owner': 'string',
              'marketplaceInformation': {
                  'productId': 'string',
                  'productUrl': 'string'
              },
              'configurationValues': 'string',
              'podIdentityAssociations': [
                  'string',
              ],
              'namespaceConfig': {
                  'namespace': 'string'
              }
          }
      }
      
    **Response Structure**

    

    - *(dict) --* 
      

      - **addon** *(dict) --* 

        An Amazon EKS add-on. For more information, see `Amazon EKS add-ons <https://docs.aws.amazon.com/eks/latest/userguide/eks-add-ons.html>`__ in the *Amazon EKS User Guide*.

        
        

        - **addonName** *(string) --* 

          The name of the add-on.

          
        

        - **clusterName** *(string) --* 

          The name of your cluster.

          
        

        - **status** *(string) --* 

          The status of the add-on.

          
        

        - **addonVersion** *(string) --* 

          The version of the add-on.

          
        

        - **health** *(dict) --* 

          An object that represents the health of the add-on.

          
          

          - **issues** *(list) --* 

            An object representing the health issues for an add-on.

            
            

            - *(dict) --* 

              An issue related to an add-on.

              
              

              - **code** *(string) --* 

                A code that describes the type of issue.

                
              

              - **message** *(string) --* 

                A message that provides details about the issue and what might cause it.

                
              

              - **resourceIds** *(list) --* 

                The resource IDs of the issue.

                
                

                - *(string) --* 
            
          
        
      
        

        - **addonArn** *(string) --* 

          The Amazon Resource Name (ARN) of the add-on.

          
        

        - **createdAt** *(datetime) --* 

          The Unix epoch timestamp at object creation.

          
        

        - **modifiedAt** *(datetime) --* 

          The Unix epoch timestamp for the last modification to the object.

          
        

        - **serviceAccountRoleArn** *(string) --* 

          The Amazon Resource Name (ARN) of the IAM role that's bound to the Kubernetes ``ServiceAccount`` object that the add-on uses.

          
        

        - **tags** *(dict) --* 

          Metadata that assists with categorization and organization. Each tag consists of a key and an optional value. You define both. Tags don't propagate to any other cluster or Amazon Web Services resources.

          
          

          - *(string) --* 

            One part of a key-value pair that make up a tag. A ``key`` is a general label that acts like a category for more specific tag values.

            
            

            - *(string) --* 

              The optional part of a key-value pair that make up a tag. A ``value`` acts as a descriptor within a tag category (key).

              
      
    
        

        - **publisher** *(string) --* 

          The publisher of the add-on.

          
        

        - **owner** *(string) --* 

          The owner of the add-on.

          
        

        - **marketplaceInformation** *(dict) --* 

          Information about an Amazon EKS add-on from the Amazon Web Services Marketplace.

          
          

          - **productId** *(string) --* 

            The product ID from the Amazon Web Services Marketplace.

            
          

          - **productUrl** *(string) --* 

            The product URL from the Amazon Web Services Marketplace.

            
      
        

        - **configurationValues** *(string) --* 

          The configuration values that you provided.

          
        

        - **podIdentityAssociations** *(list) --* 

          An array of EKS Pod Identity associations owned by the add-on. Each association maps a role to a service account in a namespace in the cluster.

           

          For more information, see `Attach an IAM Role to an Amazon EKS add-on using EKS Pod Identity <https://docs.aws.amazon.com/eks/latest/userguide/add-ons-iam.html>`__ in the *Amazon EKS User Guide*.

          
          

          - *(string) --* 
      
        

        - **namespaceConfig** *(dict) --* 

          The namespace configuration for the addon. This specifies the Kubernetes namespace where the addon is installed.

          
          

          - **namespace** *(string) --* 

            The name of the Kubernetes namespace where the addon is installed.

            
      
    
  
  **Exceptions**
  
  *   :py:class:`EKS.Client.exceptions.InvalidParameterException`

  
  *   :py:class:`EKS.Client.exceptions.InvalidRequestException`

  
  *   :py:class:`EKS.Client.exceptions.ResourceNotFoundException`

  
  *   :py:class:`EKS.Client.exceptions.ResourceInUseException`

  
  *   :py:class:`EKS.Client.exceptions.ClientException`

  
  *   :py:class:`EKS.Client.exceptions.ServerException`

  