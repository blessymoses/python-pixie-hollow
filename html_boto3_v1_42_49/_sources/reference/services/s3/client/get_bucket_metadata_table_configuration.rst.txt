:doc:`S3 <../../s3>` / Client / get_bucket_metadata_table_configuration

***************************************
get_bucket_metadata_table_configuration
***************************************



.. py:method:: S3.Client.get_bucket_metadata_table_configuration(**kwargs)

  

  .. warning::

    

    We recommend that you retrieve your S3 Metadata configurations by using the V2 `GetBucketMetadataTableConfiguration <https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetBucketMetadataTableConfiguration.html>`__ API operation. We no longer recommend using the V1 ``GetBucketMetadataTableConfiguration`` API operation.

     

    If you created your S3 Metadata configuration before July 15, 2025, we recommend that you delete and re-create your configuration by using `CreateBucketMetadataConfiguration <https://docs.aws.amazon.com/AmazonS3/latest/API/API_CreateBucketMetadataConfiguration.html>`__ so that you can expire journal table records and create a live inventory table.

     

   

  Retrieves the V1 S3 Metadata configuration for a general purpose bucket. For more information, see `Accelerating data discovery with S3 Metadata <https://docs.aws.amazon.com/AmazonS3/latest/userguide/metadata-tables-overview.html>`__ in the *Amazon S3 User Guide*.

   

  .. note::

    

    You can use the V2 ``GetBucketMetadataConfiguration`` API operation with V1 or V2 metadata table configurations. However, if you try to use the V1 ``GetBucketMetadataTableConfiguration`` API operation with V2 configurations, you will receive an HTTP ``405 Method Not Allowed`` error.

     

    Make sure that you update your processes to use the new V2 API operations ( ``CreateBucketMetadataConfiguration``, ``GetBucketMetadataConfiguration``, and ``DeleteBucketMetadataConfiguration``) instead of the V1 API operations.

    

    Permissions  

  To use this operation, you must have the ``s3:GetBucketMetadataTableConfiguration`` permission. For more information, see `Setting up permissions for configuring metadata tables <https://docs.aws.amazon.com/AmazonS3/latest/userguide/metadata-tables-permissions.html>`__ in the *Amazon S3 User Guide*.

     

  The following operations are related to ``GetBucketMetadataTableConfiguration``:

   

  
  * `CreateBucketMetadataTableConfiguration <https://docs.aws.amazon.com/AmazonS3/latest/API/API_CreateBucketMetadataTableConfiguration.html>`__
   
  * `DeleteBucketMetadataTableConfiguration <https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucketMetadataTableConfiguration.html>`__
  

   

  .. warning::

     

    You must URL encode any signed header values that contain spaces. For example, if your header value is ``my file.txt``, containing two spaces after ``my``, you must URL encode this value to ``my%20%20file.txt``.

    

  

  See also: `AWS API Documentation <https://docs.aws.amazon.com/goto/WebAPI/s3-2006-03-01/GetBucketMetadataTableConfiguration>`_  


  **Request Syntax**
  ::

    response = client.get_bucket_metadata_table_configuration(
        Bucket='string',
        ExpectedBucketOwner='string'
    )
    
  :type Bucket: string
  :param Bucket: **[REQUIRED]** 

    The general purpose bucket that corresponds to the metadata table configuration that you want to retrieve.

    

  
  :type ExpectedBucketOwner: string
  :param ExpectedBucketOwner: 

    The expected owner of the general purpose bucket that you want to retrieve the metadata table configuration for.

    

  
  
  :rtype: dict
  :returns: 
    
    **Response Syntax**

    
    ::

      {
          'GetBucketMetadataTableConfigurationResult': {
              'MetadataTableConfigurationResult': {
                  'S3TablesDestinationResult': {
                      'TableBucketArn': 'string',
                      'TableName': 'string',
                      'TableArn': 'string',
                      'TableNamespace': 'string'
                  }
              },
              'Status': 'string',
              'Error': {
                  'ErrorCode': 'string',
                  'ErrorMessage': 'string'
              }
          }
      }
      
    **Response Structure**

    

    - *(dict) --* 
      

      - **GetBucketMetadataTableConfigurationResult** *(dict) --* 

        The metadata table configuration for the general purpose bucket.

        
        

        - **MetadataTableConfigurationResult** *(dict) --* 

          The V1 S3 Metadata configuration for a general purpose bucket.

          
          

          - **S3TablesDestinationResult** *(dict) --* 

            The destination information for the metadata table configuration. The destination table bucket must be in the same Region and Amazon Web Services account as the general purpose bucket. The specified metadata table name must be unique within the ``aws_s3_metadata`` namespace in the destination table bucket.

            
            

            - **TableBucketArn** *(string) --* 

              The Amazon Resource Name (ARN) for the table bucket that's specified as the destination in the metadata table configuration. The destination table bucket must be in the same Region and Amazon Web Services account as the general purpose bucket.

              
            

            - **TableName** *(string) --* 

              The name for the metadata table in your metadata table configuration. The specified metadata table name must be unique within the ``aws_s3_metadata`` namespace in the destination table bucket.

              
            

            - **TableArn** *(string) --* 

              The Amazon Resource Name (ARN) for the metadata table in the metadata table configuration. The specified metadata table name must be unique within the ``aws_s3_metadata`` namespace in the destination table bucket.

              
            

            - **TableNamespace** *(string) --* 

              The table bucket namespace for the metadata table in your metadata table configuration. This value is always ``aws_s3_metadata``.

              
        
      
        

        - **Status** *(string) --* 

          The status of the metadata table. The status values are:

           

          
          * ``CREATING`` - The metadata table is in the process of being created in the specified table bucket.
           
          * ``ACTIVE`` - The metadata table has been created successfully, and records are being delivered to the table.
           
          * ``FAILED`` - Amazon S3 is unable to create the metadata table, or Amazon S3 is unable to deliver records. See ``ErrorDetails`` for details.
          

          
        

        - **Error** *(dict) --* 

          If the ``CreateBucketMetadataTableConfiguration`` request succeeds, but S3 Metadata was unable to create the table, this structure contains the error code and error message.

          
          

          - **ErrorCode** *(string) --* 

            If the V1 ``CreateBucketMetadataTableConfiguration`` request succeeds, but S3 Metadata was unable to create the table, this structure contains the error code. The possible error codes and error messages are as follows:

             

            
            * ``AccessDeniedCreatingResources`` - You don't have sufficient permissions to create the required resources. Make sure that you have ``s3tables:CreateNamespace``, ``s3tables:CreateTable``, ``s3tables:GetTable`` and ``s3tables:PutTablePolicy`` permissions, and then try again. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``AccessDeniedWritingToTable`` - Unable to write to the metadata table because of missing resource permissions. To fix the resource policy, Amazon S3 needs to create a new metadata table. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``DestinationTableNotFound`` - The destination table doesn't exist. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``ServerInternalError`` - An internal error has occurred. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``TableAlreadyExists`` - The table that you specified already exists in the table bucket's namespace. Specify a different table name. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``TableBucketNotFound`` - The table bucket that you specified doesn't exist in this Amazon Web Services Region and account. Create or choose a different table bucket. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
            

             

            If the V2 ``CreateBucketMetadataConfiguration`` request succeeds, but S3 Metadata was unable to create the table, this structure contains the error code. The possible error codes and error messages are as follows:

             

            
            * ``AccessDeniedCreatingResources`` - You don't have sufficient permissions to create the required resources. Make sure that you have ``s3tables:CreateTableBucket``, ``s3tables:CreateNamespace``, ``s3tables:CreateTable``, ``s3tables:GetTable``, ``s3tables:PutTablePolicy``, ``kms:DescribeKey``, and ``s3tables:PutTableEncryption`` permissions. Additionally, ensure that the KMS key used to encrypt the table still exists, is active and has a resource policy granting access to the S3 service principals ' ``maintenance.s3tables.amazonaws.com``' and ' ``metadata.s3.amazonaws.com``'. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``AccessDeniedWritingToTable`` - Unable to write to the metadata table because of missing resource permissions. To fix the resource policy, Amazon S3 needs to create a new metadata table. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``DestinationTableNotFound`` - The destination table doesn't exist. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``ServerInternalError`` - An internal error has occurred. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``JournalTableAlreadyExists`` - A journal table already exists in the Amazon Web Services managed table bucket's namespace. Delete the journal table, and then try again. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``InventoryTableAlreadyExists`` - An inventory table already exists in the Amazon Web Services managed table bucket's namespace. Delete the inventory table, and then try again. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``JournalTableNotAvailable`` - The journal table that the inventory table relies on has a ``FAILED`` status. An inventory table requires a journal table with an ``ACTIVE`` status. To create a new journal or inventory table, you must delete the metadata configuration for this bucket, along with any journal or inventory tables, and then create a new metadata configuration.
             
            * ``NoSuchBucket`` - The specified general purpose bucket does not exist.
            

            
          

          - **ErrorMessage** *(string) --* 

            If the V1 ``CreateBucketMetadataTableConfiguration`` request succeeds, but S3 Metadata was unable to create the table, this structure contains the error message. The possible error codes and error messages are as follows:

             

            
            * ``AccessDeniedCreatingResources`` - You don't have sufficient permissions to create the required resources. Make sure that you have ``s3tables:CreateNamespace``, ``s3tables:CreateTable``, ``s3tables:GetTable`` and ``s3tables:PutTablePolicy`` permissions, and then try again. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``AccessDeniedWritingToTable`` - Unable to write to the metadata table because of missing resource permissions. To fix the resource policy, Amazon S3 needs to create a new metadata table. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``DestinationTableNotFound`` - The destination table doesn't exist. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``ServerInternalError`` - An internal error has occurred. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``TableAlreadyExists`` - The table that you specified already exists in the table bucket's namespace. Specify a different table name. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``TableBucketNotFound`` - The table bucket that you specified doesn't exist in this Amazon Web Services Region and account. Create or choose a different table bucket. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
            

             

            If the V2 ``CreateBucketMetadataConfiguration`` request succeeds, but S3 Metadata was unable to create the table, this structure contains the error code. The possible error codes and error messages are as follows:

             

            
            * ``AccessDeniedCreatingResources`` - You don't have sufficient permissions to create the required resources. Make sure that you have ``s3tables:CreateTableBucket``, ``s3tables:CreateNamespace``, ``s3tables:CreateTable``, ``s3tables:GetTable``, ``s3tables:PutTablePolicy``, ``kms:DescribeKey``, and ``s3tables:PutTableEncryption`` permissions. Additionally, ensure that the KMS key used to encrypt the table still exists, is active and has a resource policy granting access to the S3 service principals ' ``maintenance.s3tables.amazonaws.com``' and ' ``metadata.s3.amazonaws.com``'. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``AccessDeniedWritingToTable`` - Unable to write to the metadata table because of missing resource permissions. To fix the resource policy, Amazon S3 needs to create a new metadata table. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``DestinationTableNotFound`` - The destination table doesn't exist. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``ServerInternalError`` - An internal error has occurred. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``JournalTableAlreadyExists`` - A journal table already exists in the Amazon Web Services managed table bucket's namespace. Delete the journal table, and then try again. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``InventoryTableAlreadyExists`` - An inventory table already exists in the Amazon Web Services managed table bucket's namespace. Delete the inventory table, and then try again. To create a new metadata table, you must delete the metadata configuration for this bucket, and then create a new metadata configuration.
             
            * ``JournalTableNotAvailable`` - The journal table that the inventory table relies on has a ``FAILED`` status. An inventory table requires a journal table with an ``ACTIVE`` status. To create a new journal or inventory table, you must delete the metadata configuration for this bucket, along with any journal or inventory tables, and then create a new metadata configuration.
             
            * ``NoSuchBucket`` - The specified general purpose bucket does not exist.
            

            
      
    
  