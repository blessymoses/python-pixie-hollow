:doc:`IoTDataPlane <../../iot-data>` / Client / publish

*******
publish
*******



.. py:method:: IoTDataPlane.Client.publish(**kwargs)

  

  Publishes an MQTT message.

   

  Requires permission to access the `Publish <https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsiot.html#awsiot-actions-as-permissions>`__ action.

   

  For more information about MQTT messages, see `MQTT Protocol <http://docs.aws.amazon.com/iot/latest/developerguide/mqtt.html>`__ in the IoT Developer Guide.

   

  For more information about messaging costs, see `Amazon Web Services IoT Core pricing - Messaging <http://aws.amazon.com/iot-core/pricing/#Messaging>`__.

  

  See also: `AWS API Documentation <https://docs.aws.amazon.com/goto/WebAPI/iot-data-2015-05-28/Publish>`_  


  **Request Syntax**
  ::

    response = client.publish(
        topic='string',
        qos=123,
        retain=True|False,
        payload=b'bytes'|file,
        userProperties={...}|[...]|123|123.4|'string'|True|None,
        payloadFormatIndicator='UNSPECIFIED_BYTES'|'UTF8_DATA',
        contentType='string',
        responseTopic='string',
        correlationData='string',
        messageExpiry=123
    )
    
  :type topic: string
  :param topic: **[REQUIRED]** 

    The name of the MQTT topic.

    

  
  :type qos: integer
  :param qos: 

    The Quality of Service (QoS) level. The default QoS level is 0.

    

  
  :type retain: boolean
  :param retain: 

    A Boolean value that determines whether to set the RETAIN flag when the message is published.

     

    Setting the RETAIN flag causes the message to be retained and sent to new subscribers to the topic.

     

    Valid values: ``true`` | ``false``

     

    Default value: ``false``

    

  
  :type payload: bytes or seekable file-like object
  :param payload: 

    The message body. MQTT accepts text, binary, and empty (null) message payloads.

     

    Publishing an empty (null) payload with **retain** = ``true`` deletes the retained message identified by **topic** from Amazon Web Services IoT Core.

    

  
  :type userProperties: JSON serializable
  :param userProperties: 

    A JSON string that contains an array of JSON objects. If you donâ€™t use Amazon Web Services SDK or CLI, you must encode the JSON string to base64 format before adding it to the HTTP header. ``userProperties`` is an HTTP header value in the API.

     

    The following example ``userProperties`` parameter is a JSON string which represents two User Properties. Note that it needs to be base64-encoded:

     

    ``[{"deviceName": "alpha"}, {"deviceCnt": "45"}]``

    

  
  :type payloadFormatIndicator: string
  :param payloadFormatIndicator: 

    An ``Enum`` string value that indicates whether the payload is formatted as UTF-8. ``payloadFormatIndicator`` is an HTTP header value in the API.

    

  
  :type contentType: string
  :param contentType: 

    A UTF-8 encoded string that describes the content of the publishing message.

    

  
  :type responseTopic: string
  :param responseTopic: 

    A UTF-8 encoded string that's used as the topic name for a response message. The response topic is used to describe the topic which the receiver should publish to as part of the request-response flow. The topic must not contain wildcard characters.

    

  
  :type correlationData: string
  :param correlationData: 

    The base64-encoded binary data used by the sender of the request message to identify which request the response message is for when it's received. ``correlationData`` is an HTTP header value in the API.

    

  
  :type messageExpiry: integer
  :param messageExpiry: 

    A user-defined integer value that represents the message expiry interval in seconds. If absent, the message doesn't expire. For more information about the limits of ``messageExpiry``, see `Amazon Web Services IoT Core message broker and protocol limits and quotas <https://docs.aws.amazon.com/general/latest/gr/iot-core.html#message-broker-limits>`__ from the Amazon Web Services Reference Guide.

    

  
  
  :returns: None
  **Exceptions**
  
  *   :py:class:`IoTDataPlane.Client.exceptions.InternalFailureException`

  
  *   :py:class:`IoTDataPlane.Client.exceptions.InvalidRequestException`

  
  *   :py:class:`IoTDataPlane.Client.exceptions.UnauthorizedException`

  
  *   :py:class:`IoTDataPlane.Client.exceptions.MethodNotAllowedException`

  
  *   :py:class:`IoTDataPlane.Client.exceptions.ThrottlingException`

  